!########################################################################
!
!     MOLecular Hydrogen dat by CR model  MOLHCR
!
!     Data from amujuel Mar 8 2016
!     Equation and parameter for rate coefficient:
!             sum(log(Te)**j * sum(B_ij * log(E)**i),i=0..8),j=0..8
!
!     K.Hoshino 2016/8/11
!########################################################################

!      program amjuel
!        call sigv_test
!        stop
!      end

!########################################################################
      subroutine sigv_test

      implicit none

      integer k,m,n
      real*8 te,ne
      real*8 sigvv(1:6)
      real*8 sv_molhcr

      call set_molhcr

!      m=2
!      do i=0,8
!       write(*,'(i4,9e17.9)')i,(bij(j,i,m),j=0,8)
!      enddo
!      write(*,*)

      ne=1.0d20

      do m=1,6
        write(10+m,'(9a18)')
     &     "#te","1e8","1e10","1e12","1e14","1e16","1e18"
        do k=0,40
          te = 10.0d0**(dble(k-10)*0.1d0)

          do n=1,6
            ne=10.0d0**dble(12+n*2)

!            write(*,'(2e18.9)')te,ne

             sigvv(n) = sv_molhcr(te,ne,m)
!            write(*,*)te,sigv
           enddo
        write(10+m,'(8e18.9)')te,sigvv
        enddo
      enddo

      return
      end

!########################################################################
      real*8 function sv_molhcr(te,ne,nreac)
!
!     Equation and parameter for rate coefficient:
!             sum(log(Te)**j * sum(B_ij * log(E)**i),i=0..8),j=0..8
      use cmolhy, only : bij
      implicit none
! added 2 lines organize local variables and include files by kamata 2021/05/31
      real(8), intent(in) :: te, ne
      integer, intent(in) :: nreac

      real*8  sigv
! deleted 2 lines organize local variables and include files by kamata 2021/05/31
!ik   real*8  te, ne, zte, zne
!ik   integer n

! modified 2/1 lines replace all include files with module files by kamata 2021/08/18
!ik   real*8 bij(0:8, 0:8, 1:6)
!ik   common /DS_data/ bij
! bij moves to cmolhy

! modified 1/1 lines organize local variables and include files by kamata 2021/05/31
!ik   integer i, j, nreac
      integer i, j
      real*8  logte, logne, cte, cne, fac

! deleted 6 lines organize local variables and include files by kamata 2021/05/31
!ik   zne=ne
!ik   zne = max(1.0d14, zne)
!ik   zne = min(1.0d22, zne)
!ik   zte=te
!ik   zte = max(0.1d0,  zne)
!ik   zte = min(1.0d3,  zne)
!       TEMIN = 0.10000D 00 EV
!       TEMAX = 1.00000D 03 EV
!       NEMIN = 1.00000D 08 1/CM3 1D14/m3
!       NEMAX = 1.00000D 16 1/CM3 1D22/m3

      logne = dlog(ne * 1.0d-8 * 1.0d-6) ! ne 10^8 cm^-3
      logte = dlog(te)

      sigv = 0.0d0
      cte = 1.0d0
      do j=0,8
        cne = 1.0d0
        fac = 0.0d0
        do i=0,8
          fac = fac+bij(i,j,nreac)*cne
          cne = cne*logne
        enddo
        sigv = sigv+cte*fac
        cte = cte*logte
      enddo
      sigv=dexp(sigv)*1.0d-6
      sigv=max(sigv,1.0d-30)

      sv_molhcr = sigv

      end function

!########################################################################
      subroutine set_molhcr
      use cmolhy, only : bij
      use cunit,  only : n6
      implicit none

! modified 2/1 lines replace all include files with module files by kamata 2021/08/18
!ik   real*8 bij(0:8,0:8,1:6)
!ik   common /DS_data/ bij
! bij moves to cmolhy

      integer m
!
      write(n6,'(2x, "  molhcr is used")')

!cc DS1: e + H_2 -> e + H + H
!cc AMJUEL H4 2.2.5g  eloss = -10.5,  DSene = 3
      m=1

      bij(0:8,0,m)  = (/
     &    -2.702373D+01, -3.152103D-03,  5.990692D-03,
     &    -3.151253D-03,  7.457309D-04, -9.238664D-05,
     &     6.222558D-06, -2.160025D-07,  3.028756D-09 /)
!
      bij(0:8,1,m)  = (/
     &     1.081756D+01, -1.487217D-02,  1.417397D-02,
     &    -4.689912D-03,  7.180339D-04, -5.502799D-05,
     &     1.983066D-06, -2.207640D-08, -2.116339D-10 /)
!
      bij(0:8,2,m)  = (/
     &    -5.368872D+00,  5.419788D-03, -1.747269D-02,
     &     9.532963D-03, -2.196706D-03,  2.611447D-04,
     &    -1.695537D-05,  5.737376D-07, -7.940900D-09 /)
!
      bij(0:8,3,m)  = (/
     &     1.340684D+00,  1.058158D-02, -3.446019D-03,
     &    -7.032770D-04,  4.427959D-04, -7.370484D-05,
     &     5.746786D-06, -2.182085D-07,  3.264046D-09 /)
!
      bij(0:8,4,m)  = (/
     &    -1.561645D-01, -3.847439D-03,  3.571477D-03,
     &    -1.103306D-03,  1.476713D-04, -8.461163D-06,
     &     9.757112D-08,  8.130014D-09, -2.234996D-10 /)
!
      bij(0:8,5,m)  = (/
     &    -1.444732D-04, -3.194533D-04, -2.987368D-04,
     &     2.092095D-04, -4.339353D-05,  4.009329D-06,
     &    -1.762652D-07,  3.357860D-09, -1.857323D-11 /)
!
      bij(0:8,6,m)  = (/
     &     2.117694D-03,  2.679310D-04, -1.037559D-04,
     &     7.297054D-06,  1.454172D-06, -2.251617D-07,
     &     9.191700D-09, -2.052367D-11, -3.567739D-12 /)
!
      bij(0:8,7,m)  = (/
     &    -2.143738D-04, -3.539233D-05,  1.909399D-05,
     &    -3.819368D-06,  3.754063D-07, -2.441873D-08,
     &     1.437490D-09, -6.172309D-11,  1.104905D-12 /)
!
      bij(0:8,8,m)  = (/
     &     6.979741D-06,  1.462032D-06, -8.858635D-07,
     &     2.099830D-07, -2.606862D-08,  2.039814D-09,
     &    -1.113483D-10,  3.859777D-12, -5.909100D-14 /)

!       TEMIN = 0.10000D 00 EV
!       TEMAX = 1.00000D 03 EV
!       NEMIN = 1.00000D 08 1/CM3 1D14
!       NEMAX = 1.00000D 16 1/CM3 1D22


!cc DS:  e + H_2 -> 2e + H_2^+
!cc AMJUEL H4 2.2.9  eloss = -15.4, DSene = 0
      m=2

      bij(0:8,0,m)  = (/
     &    -3.574774D+01,  3.470247D-01, -9.683167D-02,
     &     1.959576D-03,  2.479361D-03, -1.196633D-04,
     &    -1.862956D-05,  1.669867D-06, -3.673736D-08 /)
!
      bij(0:8,1,m)  = (/
     &     1.769209D+01, -1.311170D+00,  4.700486D-01,
     &    -5.521175D-02, -2.689652D-03,  7.308916D-04,
     &    -2.920561D-05, -3.148831D-07,  2.514856D-08 /)
!
      bij(0:8,2,m)  = (/
     &    -8.291764D+00,  1.591702D+00, -5.814996D-01,
     &     9.160898D-02, -4.770790D-03,  1.994776D-05,
     &    -7.511552D-06,  1.089690D-06, -2.920863D-08 /)
!
      bij(0:8,3,m)  = (/
     &     2.555712D+00, -8.625269D-01,  2.612077D-01,
     &    -3.686525D-02,  1.945481D-03, -3.690918D-05,
     &     4.836340D-06, -4.165749D-07,  9.265898D-09 /)
!
      bij(0:8,4,m)  = (/
     &    -5.370405D-01,  2.375817D-01, -4.165909D-02,
     &     1.732469D-03,  3.693513D-04, -4.931268D-05,
     &     2.727502D-06, -1.081027D-07,  2.420509D-09 /)
!
      bij(0:8,5,m)  = (/
     &     7.443308D-02, -3.322214D-02, -2.351236D-03,
     &     1.723054D-03, -2.096626D-04,  1.358576D-05,
     &    -1.041586D-06,  6.928574D-08, -1.746656D-09 /)
!
      bij(0:8,6,m)  = (/
     &    -6.391786D-03,  1.862554D-03,  1.540632D-03,
     &    -3.547151D-04,  1.392157D-05,  1.047464D-06,
     &     1.513511D-08, -9.915500D-09,  3.298174D-10 /)
!
      bij(0:8,7,m)  = (/
     &     3.001729D-04,  3.497202D-05, -1.742029D-04,
     &     2.296552D-05,  2.357520D-06, -5.306086D-07,
     &     2.223137D-08,  3.340169D-10, -2.560543D-11 /)
!
      bij(0:8,8,m)  = (/
     &    -5.607183D-06, -5.779550D-06,  6.495743D-06,
     &    -3.040011D-07, -2.361543D-07,  3.655056D-08,
     &    -1.771479D-09,  1.334615D-11,  6.831565D-13 /)


!cc DS3:  e + H_2 -> 2e + H + H^+
!cc AMJUEL H4 2.2.10  eloss = -25.0,  DSene = 5
      m=3

      bij(0:8,0,m)  = (/
     &    -3.793749D+01, -3.333163D-01,  1.849601D-01,
     &    -8.803945D-02,  2.205180D-02, -2.852568D-03,
     &     1.942315D-04, -6.597388D-06,  8.798545D-08 /)
!
      bij(0:8,1,m)  = (/
     &     1.280249D+01,  1.028969D+00, -3.271855D-01,
     &     1.305597D-01, -3.408440D-02,  4.591924D-03,
     &    -3.167471D-04,  1.070920D-05, -1.408140D-07 /)
!
      bij(0:8,2,m)  = (/
     &    -3.778149D+00, -1.415561D+00,  2.928510D-01,
     &    -7.425166D-02,  2.028425D-02, -3.042377D-03,
     &     2.279125D-04, -8.197225D-06,  1.130682D-07 /)
!
      bij(0:8,3,m)  = (/
     &     2.499988D-01,  1.032923D+00, -1.580288D-01,
     &     9.934703D-03, -2.450846D-03,  5.716647D-04,
     &    -5.339116D-05,  2.135848D-06, -3.072223D-08 /)
!
      bij(0:8,4,m)  = (/
     &     2.480575D-01, -4.372934D-01,  6.448433D-02,
     &     1.229223D-03, -9.281411D-04,  5.946236D-05,
     &    -8.758032D-08, -7.270955D-08,  1.100087D-09 /)
!
      bij(0:8,5,m)  = (/
     &    -9.960628D-02,  1.092652D-01, -1.782308D-02,
     &     1.192181D-04,  2.310637D-04, -2.492991D-05,
     &     1.217600D-06, -3.624263D-08,  6.139167D-10 /)
!
      bij(0:8,6,m)  = (/
     &     1.709129D-02, -1.574889D-02,  2.865311D-03,
     &    -1.700396D-04, -1.502645D-06,  3.297869D-07,
     &     6.572135D-10,  4.269190D-10, -3.666091D-11 /)
!
      bij(0:8,7,m)  = (/
     &    -1.435305D-03,  1.203823D-03, -2.350465D-04,
     &     2.507288D-05, -3.077976D-06,  3.748300D-07,
     &    -2.613600D-08,  8.263175D-10, -8.509179D-12 /)
!
      bij(0:8,8,m)  = (/
     &     4.808640D-05, -3.761592D-05,  7.490531D-06,
     &    -1.077315D-06,  1.950248D-07, -2.569730D-08,
     &     1.804378D-09, -6.031847D-11,  7.416020D-13 /)


!cc DS4: e + H_2^+ -> e + H + H^+
!cc AMJUEL H4 2.2.12  eloss = -10.4, DSene = 4.3
      m=4

      bij(0:8,0,m)  = (/
     &    -1.793443D+01, -4.932784D-02,  1.039088D-01,
     &    -4.375935D-02,  9.196692D-03, -1.043379D-03,
     &     6.600342D-05, -2.198466D-06,  3.004146D-08 /)
!
      bij(0:8,1,m)  = (/
     &     2.236109D+00, -2.545406D-02, -1.160421D-01,
     &     4.407847D-02, -8.192521D-03,  8.200277D-04,
     &    -4.508284D-05,  1.282825D-06, -1.474719D-08 /)
!
      bij(0:8,2,m)  = (/
     &    -3.620019D-01,  6.721528D-02,  1.564387D-02,
     &    -4.939045D-03,  4.263196D-04,  1.034217D-05,
     &    -3.975029D-06,  2.322116D-07, -4.381217D-09 /)
!
      bij(0:8,3,m)  = (/
     &    -4.353922D-01, -3.051034D-02,  3.512861D-02,
     &    -1.179505D-02,  2.091773D-03, -1.991100D-04,
     &     1.018080D-05, -2.597942D-07,  2.524118D-09 /)
!
      bij(0:8,4,m)  = (/
     &     1.580382D-01,  2.493655D-03, -1.601971D-02,
     &     5.346710D-03, -8.711870D-04,  7.542067D-05,
     &    -3.410778D-06,  7.120461D-08, -4.412295D-10 /)
!
      bij(0:8,5,m)  = (/
     &     1.697881D-02,  2.106676D-03,  4.521983D-04,
     &    -3.017152D-04,  6.209239D-05, -7.598119D-06,
     &     5.523273D-07, -2.130508D-08,  3.319100D-10 /)
!
      bij(0:8,6,m)  = (/
     &    -1.521915D-02, -7.527862D-04,  9.095551D-04,
     &    -2.372576D-04,  3.018561D-05, -1.365256D-06,
     &    -4.604770D-08,  5.867910D-09, -1.357779D-10 /)
!
      bij(0:8,7,m)  = (/
     &     2.406276D-03,  9.971362D-05, -1.760978D-04,
     &     4.877659D-05, -6.477358D-06,  3.541106D-07,
     &     1.309773D-09, -8.072907D-10,  2.074669D-11 /)
!
      bij(0:8,8,m)  = (/
     &    -1.219470D-04, -4.785506D-06,  9.858840D-06,
     &    -2.779211D-06,  3.720380D-07, -2.110290D-08,
     &     3.753875D-11,  4.024907D-11, -1.075991D-12 /)


!cc DS5: e + H_2^+ -> 2e + H^+ + H^+
!cc AMJUEL H4 2.2.11  eloss = -15.5, DSene = 0.25
      m=5

      bij(0:8,0,m)  = (/
     &    -3.708804D+01,  9.784234D-02, -7.200361D-03,
     &     6.496843D-03, -1.420591D-03,  1.703620D-04,
     &    -1.160739D-05,  4.148222D-07, -6.007853D-09 /)
!
      bij(0:8,1,m)  = (/
     &     1.561781D+01, -1.673256D-02,  2.743323D-02,
     &    -1.026956D-02,  1.999562D-03, -2.043608D-04,
     &     1.084177D-05, -2.671801D-07,  2.093182D-09 /)
!
      bij(0:8,2,m)  = (/
     &    -6.874406D+00, -7.782930D-03, -6.888774D-03,
     &     2.306107D-03, -4.029223D-04,  3.932152D-05,
     &    -2.094907D-06,  5.682907D-08, -6.320753D-10 /)
!
      bij(0:8,3,m)  = (/
     &     2.010540D+00, -3.226785D-03, -6.181192D-03,
     &     2.388147D-03, -5.018901D-04,  5.520234D-05,
     &    -3.080799D-06,  7.864770D-08, -6.357395D-10 /)
!
      bij(0:8,4,m)  = (/
     &    -3.614769D-01,  3.710099D-03,  2.045815D-03,
     &    -8.523936D-04,  1.751295D-04, -1.944204D-05,
     &     1.138888D-06, -3.256304D-08,  3.501794D-10 /)
!
      bij(0:8,5,m)  = (/
     &     2.956861D-02, -5.524444D-04, -2.457951D-05,
     &     3.433180D-05, -1.450209D-06, -2.447566D-07,
     &     1.375679D-08,  4.863881D-10, -3.004374D-11 /)
!
      bij(0:8,6,m)  = (/
     &     9.662490D-04, -1.548557D-04,  1.417215D-05,
     &    -6.444864D-06, -1.566029D-06,  4.152487D-07,
     &    -2.855069D-08,  6.081805D-10,  9.512866D-13 /)
!
      bij(0:8,7,m)  = (/
     &    -3.543572D-04,  4.662969D-05, -1.471118D-05,
     &     5.235585D-06, -5.779668D-07,  2.139729D-08,
     &    -3.656048D-10,  3.759866D-11, -1.486151D-12 /)
!
      bij(0:8,8,m)  = (/
     &     1.827110D-05, -3.179896D-06,  1.432429D-06,
     &    -5.141065D-07,  7.734387D-08, -6.163337D-09,
     &     3.128314D-10, -1.061842D-11,  1.771100D-13 /)


!cc DS6:  e + H_2^+ -> H + H
!cc AMJUEL H4 2.2.14  eloss = 12, DSene = 0.5
      m=6

      bij(0:8,0,m)  = (/
     &    -1.664335D+01,  8.953781D-02, -1.056411D-01,
     &     4.477001D-02, -9.729945D-03,  1.174457D-03,
     &    -7.987744D-05,  2.842958D-06, -4.104509D-08 /)
!
      bij(0:8,1,m)  = (/
     &    -6.005444D-01,  4.063934D-02, -4.753948D-02,
     &     2.188304D-02, -5.201086D-03,  6.866340D-04,
     &    -5.059940D-05,  1.930214D-06, -2.963967D-08 /)
!
      bij(0:8,2,m)  = (/
     &     4.494812D-04,  7.884509D-05,  3.688008D-04,
     &    -4.659256D-04,  1.907116D-04, -3.434325D-05,
     &     3.067652D-06, -1.325689D-07,  2.212493D-09 /)
!
      bij(0:8,3,m)  = (/
     &     1.632895D-04,  3.108116D-04, -3.521553D-04,
     &    -2.233170D-04,  1.869415D-04, -4.329991D-05,
     &     4.465257D-06, -2.136296D-07,  3.873085D-09 /)
!
      bij(0:8,4,m)  = (/
     &    -7.234143D-05, -1.316311D-03,  1.643509D-03,
     &    -6.412764D-04,  1.048891D-04, -7.018555D-06,
     &     4.776213D-08,  1.380537D-08, -4.199398D-10 /)
!
      bij(0:8,5,m)  = (/
     &    -1.504085D-05,  1.315866D-04, -1.025654D-04,
     &     5.310325D-05, -1.831888D-05,  3.423755D-06,
     &    -3.303384D-07,  1.551627D-08, -2.809392D-10 /)
!
      bij(0:8,6,m)  = (/
     &     1.113924D-05,  2.711412D-05, -8.495922D-05,
     &     4.026488D-05, -6.289324D-06,  1.911447D-07,
     &     3.638198D-08, -3.235541D-09,  7.605442D-11 /)
!
      bij(0:8,7,m)  = (/
     &    -1.843926D-06, -1.663675D-06,  1.308070D-05,
     &    -7.324021D-06,  1.431740D-06, -1.085645D-07,
     &     1.143165D-09,  2.151595D-10, -7.052562D-12 /)
!
      bij(0:8,8,m)  = (/
     &     9.864173D-08, -2.212262D-07, -4.431750D-07,
     &     3.270531D-07, -7.282086D-08,  6.578254D-09,
     &    -1.925258D-10, -4.217474D-12,  2.364754D-13 /)

      return
      end subroutine

